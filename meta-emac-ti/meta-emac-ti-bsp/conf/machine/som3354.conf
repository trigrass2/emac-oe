#@TYPE: Machine
#@NAME: SoM3354
#@DESCRIPTION: Machine configuration for EMAC's SoM-3354

MACHINEOVERRIDES =. "ti:ti33x:"

include conf/machine/include/ti33x.inc

MACHINE_FEATURES:append = " can screen touchscreen sound wifi gpu mtd arm "
MACHINE_EXTRA_RDEPENDS:append = " linux-firmware-sd8787 "

PREFERRED_PROVIDER_virtual/kernel = "linux-ti-staging"
PREFERRED_VERSION_linux-libc-headers = "5.10%"
MACHINE_ESSENTIAL_EXTRA_RDEPENDS:append = " \
    kernel-image \
    kernel-devicetree \
    ${@bb.utils.contains('KERNEL_DEVICETREE_BUNDLE','1', 'kernel-image-zimage-bundle','',d)} \
"
KERNEL_DEVICETREE_BUNDLE = "1"
KERNEL_IMAGETYPE = "zImage"
KERNEL_DEVICETREE = " \
	som-3354-200es.dtb \
	som-3354-200gs.dtb \
	som-3354-210es.dtb \
	som-3354-212es.dtb \
	som-3354-250es-7.dtb \
	som-3354-250es-10.dtb \
	som-3354-250gs-7.dtb \
"


PREFERRED_PROVIDER_virtual/bootloader = "u-boot-emac"
PREFERRED_VERSION_u-boot-emac = "v2020.04%"
MACHINE_ESSENTIAL_EXTRA_RDEPENDS:append = " ${PREFERRED_PROVIDER_virtual/bootloader}"

UBOOT_MACHINE = "som3354_spiboot_config"
UBOOT_SUFFIX = "img"
SPL_BINARY = "MLO.byteswap spl/u-boot-spl.bin"

SERIAL_CONSOLES = "115200;ttyO0"

IMAGE_FSTYPES += " tar.gz "
IMAGE_FSTYPES:remove = " wic wic.bmap ubifs ubi "
PREFERRED_PROVIDER_virtual/egl = "ti-sgx-ddk-um"
PREFERRED_PROVIDER_virtual/libgles1 = "ti-sgx-ddk-um"
PREFERRED_PROVIDER_virtual/libgles2 = "ti-sgx-ddk-um"
PREFERRED_PROVIDER_virtual/libgbm = "ti-sgx-ddk-um"
PREFERRED_PROVIDER_virtual/gpudriver = "ti-sgx-ddk-km"

PREFERRED_PROVIDER_libltdl ="libtool"

MACHINE_EXTRA_RDEPENDS += " \
	ti-sgx-ddk-km \
	ti-sgx-ddk-um \
	ti-codec-engine \
	alsa-state \
	wayland-dev  \
	libegl-dev \
	libdrm-dev \
	libegl \
	glmark2 \
	libdrm-kms \
	libegl \
	kmscube \
	img-pvr-sdk \
"
	
#	protection-relays-hmi 
#	mmwavegesture-hmi 
#	evse-hmi 
# * bsp
# vxd-dec-fw
# cmem 
# uio-module-drv

# * extras
# bt-fw
# wl18xx-fw
# wl18xx-calibrator
# wl18xx-target-scripts
# wlconf
# uim-sysfs(sys5)
# cuia
# ti-sysbios
# ti-framework-components
# ti-osal
# swtools
# ti-xdais

# * arago-distro
# glmark2
# arm-benchmarks
# nbench-byte
## stream
# gtk+3 gtk+3-demo
# opencl opencl-runtime opencl-examples-offline-compile

SOM_NUMBER = "08"
BOOTSTRAP_REV = "00.000"
UBOOT_REV = "00.000"
KERNEL_REV = "00.000"
FILESYSTEM_REV = "00.000"
